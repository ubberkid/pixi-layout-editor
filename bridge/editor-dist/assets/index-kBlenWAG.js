var K=Object.defineProperty;var X=(n,e,t)=>e in n?K(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var d=(n,e,t)=>X(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();class U{constructor(){d(this,"_channel",null);d(this,"_handlers",new Map);d(this,"_onStatusChange",null);d(this,"_connected",!1)}get isConnected(){return this._connected}onStatusChange(e){this._onStatusChange=e}on(e,t){this._handlers.has(e)||this._handlers.set(e,[]),this._handlers.get(e).push(t)}connect(){this._channel&&this._channel.close(),this._channel=new BroadcastChannel("layout-editor"),this._channel.onmessage=e=>{var s;this._connected||(this._connected=!0,(s=this._onStatusChange)==null||s.call(this,!0));const t=e.data,o=this._handlers.get(t.type);o&&o.forEach(i=>i(t))},this.send({type:"get-hierarchy"}),setTimeout(()=>{this._connected||console.log("No response from game - make sure you are in the BingoGameScene")},1e3)}disconnect(){var e,t;(e=this._channel)==null||e.close(),this._channel=null,this._connected=!1,(t=this._onStatusChange)==null||t.call(this,!1)}send(e){var t;(t=this._channel)==null||t.postMessage(e)}}const p=new U;class Q{constructor(e){d(this,"_container");d(this,"_hierarchy",[]);d(this,"_selectedId",null);d(this,"_expandedIds",new Set);d(this,"_onSelect",null);d(this,"_onHover",null);this._container=document.getElementById(e)}onSelect(e){this._onSelect=e}onHover(e){this._onHover=e}getSelectedId(){return this._selectedId}setHierarchy(e){this._hierarchy=e,e.forEach(t=>this._expandedIds.add(t.id)),this.render()}getNodeById(e){const t=o=>{for(const s of o){if(s.id===e)return s;const i=t(s.children);if(i)return i}return null};return t(this._hierarchy)}render(){this._container.innerHTML="",this._hierarchy.forEach(e=>{this._container.appendChild(this.renderNode(e))})}renderNode(e){const t=document.createElement("div");t.className="tree-node";const o=e.layout&&Object.keys(e.layout).length>0,s=e.layoutEnabled!==!1,i=document.createElement("div");i.className="tree-node-header",e.id===this._selectedId&&i.classList.add("selected"),s?o||i.classList.add("tree-node-no-layout"):i.classList.add("tree-node-disabled");const m=document.createElement("span");m.className="tree-node-toggle",e.children.length>0&&(m.textContent=this._expandedIds.has(e.id)?"▼":"▶",m.addEventListener("click",a=>{a.stopPropagation(),this.toggleExpand(e.id)}));const y=document.createElement("span");if(y.className="tree-node-label",y.textContent=e.id||`[${e.type}]`,s){if(o){const a=document.createElement("span");a.className="tree-node-badge",a.textContent="L",a.title="Has layout properties",y.appendChild(a)}}else{const a=document.createElement("span");a.className="tree-node-badge disabled",a.textContent="✗",a.title="Layout disabled",y.appendChild(a)}if(i.appendChild(m),i.appendChild(y),i.addEventListener("click",()=>{this.selectNode(e.id)}),i.addEventListener("mouseenter",()=>{var a;(a=this._onHover)==null||a.call(this,e.id)}),i.addEventListener("mouseleave",()=>{var a;(a=this._onHover)==null||a.call(this,null)}),t.appendChild(i),e.children.length>0){const a=document.createElement("div");a.className="tree-node-children",this._expandedIds.has(e.id)||a.classList.add("collapsed"),e.children.forEach(L=>{a.appendChild(this.renderNode(L))}),t.appendChild(a)}return t}toggleExpand(e){this._expandedIds.has(e)?this._expandedIds.delete(e):this._expandedIds.add(e),this.render()}selectNode(e){var o;this._selectedId=e,this.render();const t=this.getNodeById(e);(o=this._onSelect)==null||o.call(this,t)}}const Z=[{title:"Transform",isTransform:!0,properties:[{key:"x",type:"number",label:"x",desc:`Horizontal position in pixels relative to parent.
Examples: 0, 100, -50`},{key:"y",type:"number",label:"y",desc:`Vertical position in pixels relative to parent.
Examples: 0, 100, -50`},{key:"scaleX",type:"number",label:"scale.x",step:.1,desc:`Horizontal scale multiplier. 1 = normal size.
Examples: 1, 0.5 (half), 2 (double), -1 (flip)`},{key:"scaleY",type:"number",label:"scale.y",step:.1,desc:`Vertical scale multiplier. 1 = normal size.
Examples: 1, 0.5 (half), 2 (double), -1 (flip)`},{key:"rotation",type:"number",label:"rotation",step:.1,desc:`Rotation in radians around the pivot point.
Examples: 0, 1.57 (90°), 3.14 (180°), 6.28 (360°)`},{key:"pivotX",type:"number",label:"pivot.x",desc:`X origin for rotation/scale in local pixels.
Examples: 0 (left), width/2 (center)`},{key:"pivotY",type:"number",label:"pivot.y",desc:`Y origin for rotation/scale in local pixels.
Examples: 0 (top), height/2 (center)`},{key:"anchorX",type:"number",label:"anchor.x",step:.1,desc:`X anchor as fraction of texture (Sprites only).
Examples: 0 (left), 0.5 (center), 1 (right)`},{key:"anchorY",type:"number",label:"anchor.y",step:.1,desc:`Y anchor as fraction of texture (Sprites only).
Examples: 0 (top), 0.5 (center), 1 (bottom)`},{key:"alpha",type:"number",label:"alpha",step:.1,desc:`Opacity from 0 (invisible) to 1 (fully visible).
Examples: 1, 0.5 (semi-transparent), 0`}]},{title:"Size",properties:[{key:"width",type:"text",label:"width",desc:`Container width. Accepts pixels or percentage.
Examples: 100, "50%", "auto"`},{key:"height",type:"text",label:"height",desc:`Container height. Accepts pixels or percentage.
Examples: 100, "50%", "auto"`},{key:"minWidth",type:"number",label:"minWidth",desc:`Minimum width constraint in pixels.
Examples: 100, 200`},{key:"maxWidth",type:"number",label:"maxWidth",desc:`Maximum width constraint in pixels.
Examples: 500, 1000`},{key:"minHeight",type:"number",label:"minHeight",desc:`Minimum height constraint in pixels.
Examples: 100, 200`},{key:"maxHeight",type:"number",label:"maxHeight",desc:`Maximum height constraint in pixels.
Examples: 500, 1000`}]},{title:"Flexbox Container",properties:[{key:"flexDirection",type:"select",label:"flexDirection",desc:`Main axis direction for laying out children.
• row: left to right
• column: top to bottom
• row-reverse: right to left
• column-reverse: bottom to top`,options:["row","column","row-reverse","column-reverse"]},{key:"flexWrap",type:"select",label:"flexWrap",desc:`Whether children wrap to new lines.
• nowrap: single line, may overflow
• wrap: wrap to next line
• wrap-reverse: wrap upward/leftward`,options:["nowrap","wrap","wrap-reverse"]},{key:"justifyContent",type:"select",label:"justifyContent",desc:`Align children along the main axis.
• flex-start: pack at start
• flex-end: pack at end
• center: center items
• space-between: equal space between
• space-around: equal space around
• space-evenly: equal space everywhere`,options:["flex-start","flex-end","center","space-between","space-around","space-evenly"]},{key:"alignItems",type:"select",label:"alignItems",desc:`Align children along the cross axis.
• flex-start: align to start
• flex-end: align to end
• center: center items
• stretch: stretch to fill
• baseline: align text baselines`,options:["flex-start","flex-end","center","stretch","baseline"]},{key:"alignContent",type:"select",label:"alignContent",desc:`Align wrapped lines (only with flexWrap).
• flex-start: pack lines at start
• flex-end: pack lines at end
• center: center lines
• stretch: stretch lines to fill
• space-between: equal space between lines
• space-around: equal space around lines`,options:["flex-start","flex-end","center","stretch","space-between","space-around"]},{key:"gap",type:"number",label:"gap",desc:`Space between all children in pixels.
Examples: 0, 10, 20`},{key:"rowGap",type:"number",label:"rowGap",desc:`Space between rows in pixels (overrides gap for rows).
Examples: 0, 10, 20`},{key:"columnGap",type:"number",label:"columnGap",desc:`Space between columns in pixels (overrides gap for columns).
Examples: 0, 10, 20`}]},{title:"Flexbox Item",properties:[{key:"flex",type:"number",label:"flex",desc:`Shorthand for flex-grow. How much this item grows relative to siblings.
Examples: 0 (don't grow), 1 (grow equally), 2 (grow 2x)`},{key:"flexGrow",type:"number",label:"flexGrow",desc:`How much this item grows to fill extra space.
Examples: 0 (don't grow), 1 (grow equally), 2 (grow 2x)`},{key:"flexShrink",type:"number",label:"flexShrink",desc:`How much this item shrinks when space is tight.
Examples: 0 (don't shrink), 1 (shrink equally)`},{key:"flexBasis",type:"number",label:"flexBasis",desc:`Initial size before growing/shrinking, in pixels.
Examples: 0, 100, 200`},{key:"alignSelf",type:"select",label:"alignSelf",desc:`Override parent's alignItems for this item.
• auto: use parent's alignItems
• flex-start/end/center/stretch/baseline: same as alignItems`,options:["auto","flex-start","flex-end","center","stretch","baseline"]}]},{title:"Spacing",properties:[{key:"padding",type:"number",label:"padding",desc:`Inner spacing on all sides in pixels.
Examples: 0, 10, 20`},{key:"paddingTop",type:"number",label:"paddingTop",desc:`Inner spacing at top in pixels.
Examples: 0, 10, 20`},{key:"paddingRight",type:"number",label:"paddingRight",desc:`Inner spacing at right in pixels.
Examples: 0, 10, 20`},{key:"paddingBottom",type:"number",label:"paddingBottom",desc:`Inner spacing at bottom in pixels.
Examples: 0, 10, 20`},{key:"paddingLeft",type:"number",label:"paddingLeft",desc:`Inner spacing at left in pixels.
Examples: 0, 10, 20`},{key:"margin",type:"number",label:"margin",desc:`Outer spacing on all sides in pixels.
Examples: 0, 10, 20`},{key:"marginTop",type:"number",label:"marginTop",desc:`Outer spacing at top in pixels.
Examples: 0, 10, 20`},{key:"marginRight",type:"number",label:"marginRight",desc:`Outer spacing at right in pixels.
Examples: 0, 10, 20`},{key:"marginBottom",type:"number",label:"marginBottom",desc:`Outer spacing at bottom in pixels.
Examples: 0, 10, 20`},{key:"marginLeft",type:"number",label:"marginLeft",desc:`Outer spacing at left in pixels.
Examples: 0, 10, 20`}]}],j="layout-editor-changes",D="layout-editor-originals",A="layout-editor-transforms",R="layout-editor-sessions";class ee{constructor(e,t){d(this,"_formContainer");d(this,"_noSelectionEl");d(this,"_selectedNode",null);d(this,"_originalLayouts",new Map);d(this,"_originalTransforms",new Map);d(this,"_pendingChanges",new Map);d(this,"_onChange",null);d(this,"_onCopy",null);this._formContainer=document.getElementById(e),this._noSelectionEl=document.getElementById(t),this.loadFromStorage()}loadFromStorage(){try{const e=localStorage.getItem(j);if(e){const s=JSON.parse(e);this._pendingChanges=new Map(Object.entries(s)),console.log(`[PropertyPanel] Loaded ${this._pendingChanges.size} nodes with pending changes`)}const t=localStorage.getItem(D);if(t){const s=JSON.parse(t);this._originalLayouts=new Map(Object.entries(s))}const o=localStorage.getItem(A);if(o){const s=JSON.parse(o);this._originalTransforms=new Map(Object.entries(s))}}catch(e){console.warn("[PropertyPanel] Failed to load from storage:",e)}}saveToStorage(){try{const e=Object.fromEntries(this._pendingChanges);localStorage.setItem(j,JSON.stringify(e));const t=Object.fromEntries(this._originalLayouts);localStorage.setItem(D,JSON.stringify(t));const o=Object.fromEntries(this._originalTransforms);localStorage.setItem(A,JSON.stringify(o))}catch(e){console.warn("[PropertyPanel] Failed to save to storage:",e)}}getPendingChanges(){return this._pendingChanges}hasPendingChanges(){return this._pendingChanges.size>0}clearPendingChanges(){this._pendingChanges.clear(),this._originalLayouts.clear(),this._originalTransforms.clear(),localStorage.removeItem(j),localStorage.removeItem(D),localStorage.removeItem(A),this.render()}getSessions(){try{const e=localStorage.getItem(R);return e?JSON.parse(e):[]}catch{return[]}}saveSession(e){try{const t={changes:Object.fromEntries(this._pendingChanges),originals:Object.fromEntries(this._originalLayouts),transforms:Object.fromEntries(this._originalTransforms)};localStorage.setItem(`layout-editor-session-${e}`,JSON.stringify(t));const o=this.getSessions();o.includes(e)||(o.push(e),localStorage.setItem(R,JSON.stringify(o))),console.log(`[PropertyPanel] Saved session: ${e}`)}catch(t){console.warn("[PropertyPanel] Failed to save session:",t)}}loadSession(e){try{const t=localStorage.getItem(`layout-editor-session-${e}`);if(!t)return!1;const o=JSON.parse(t);return this._pendingChanges=new Map(Object.entries(o.changes)),this._originalLayouts=new Map(Object.entries(o.originals)),this._originalTransforms=new Map(Object.entries(o.transforms||{})),this.saveToStorage(),console.log(`[PropertyPanel] Loaded session: ${e}`),this.render(),!0}catch(t){return console.warn("[PropertyPanel] Failed to load session:",t),!1}}deleteSession(e){try{localStorage.removeItem(`layout-editor-session-${e}`);const t=this.getSessions().filter(o=>o!==e);localStorage.setItem(R,JSON.stringify(t)),console.log(`[PropertyPanel] Deleted session: ${e}`)}catch(t){console.warn("[PropertyPanel] Failed to delete session:",t)}}onChange(e){this._onChange=e}onCopy(e){this._onCopy=e}setSelectedNode(e){this._selectedNode=e,e&&(this._originalLayouts.has(e.id)||this._originalLayouts.set(e.id,e.layout?{...e.layout}:{}),this._originalTransforms.has(e.id)||this._originalTransforms.set(e.id,e.transform?{...e.transform}:{}),this.saveToStorage()),this.render()}updateNodeLayout(e,t,o){var s;((s=this._selectedNode)==null?void 0:s.id)===e&&(this._selectedNode.layout=t,o&&(this._selectedNode.transform=o))}render(){var a,L,Y;if(!this._selectedNode){this._formContainer.style.display="none",this._noSelectionEl.style.display="block";return}this._noSelectionEl.style.display="none",this._formContainer.style.display="block",this._formContainer.innerHTML="";const e=document.createElement("div");e.id="selected-name",e.textContent=this._selectedNode.id,this._formContainer.appendChild(e);const t=document.createElement("div");t.className="property-row toggle-row";const o=document.createElement("label");o.textContent="Layout Enabled";const s=document.createElement("input");s.type="checkbox",s.checked=this._selectedNode.layoutEnabled,s.addEventListener("change",()=>{var g;(g=this._onChange)==null||g.call(this,this._selectedNode.id,"_layoutEnabled",s.checked)}),t.appendChild(o),t.appendChild(s),this._formContainer.appendChild(t);const i=this._originalLayouts.get(this._selectedNode.id)||{},m=this._originalTransforms.get(this._selectedNode.id)||{};for(const g of Z){const N=document.createElement("div");N.className="property-section";const M=document.createElement("div");M.className="property-section-title",M.textContent=g.title,N.appendChild(M);for(const r of g.properties){if((r.key==="anchorX"||r.key==="anchorY")&&!((a=this._selectedNode.transform)!=null&&a.hasAnchor))continue;const S=document.createElement("div");S.className="property-row";const I=document.createElement("label");I.className="property-label",I.textContent=r.label,I.title=r.desc;let l;if(r.type==="select"){l=document.createElement("select"),l.className="property-input";const c=document.createElement("option");c.value="",c.textContent="(not set)",l.appendChild(c),r.options.forEach(E=>{const x=document.createElement("option");x.value=E,x.textContent=E,l.appendChild(x)})}else l=document.createElement("input"),l.className="property-input",l.type=r.type==="number"?"number":"text",r.step!==void 0&&(l.step=String(r.step));let O,f;if(g.isTransform){const c=r.key;O=(L=this._selectedNode.transform)==null?void 0:L[c],f=m[r.key]}else O=(Y=this._selectedNode.layout)==null?void 0:Y[r.key],f=i[r.key];O!==void 0&&(l.value=String(O),l.classList.add("has-value")),l instanceof HTMLInputElement&&(l.placeholder="(not set)");const b=document.createElement("span");b.className="property-original";const H=()=>{const c=l.value===""?void 0:l.value,E=f!==void 0?String(f):void 0,x=c!==E;x&&f!==void 0?(b.textContent=`was: ${f}`,b.style.display="inline",b.title="Click to reset"):x&&f===void 0?(b.textContent="new",b.style.display="inline",b.title="Click to clear"):b.style.display="none"};H(),b.addEventListener("click",()=>{var c;f!==void 0?l.value=String(f):l.value="",l.classList.toggle("has-value",l.value!==""),H(),(c=this._onChange)==null||c.call(this,this._selectedNode.id,r.key,f)}),l.addEventListener("change",()=>{var $;l.classList.toggle("has-value",l.value!==""),H();let c=l.value;r.type==="number"&&c!==""&&(c=parseFloat(c)),c===""&&!g.isTransform&&(c=void 0);const E=this._selectedNode.id;this._pendingChanges.has(E)||this._pendingChanges.set(E,{});const x=this._pendingChanges.get(E),W=(g.isTransform?m:i)[r.key];c!==W?x[r.key]=c:(delete x[r.key],Object.keys(x).length===0&&this._pendingChanges.delete(E)),this.saveToStorage(),($=this._onChange)==null||$.call(this,this._selectedNode.id,r.key,c)}),S.appendChild(I),S.appendChild(l),S.appendChild(b),N.appendChild(S)}this._formContainer.appendChild(N)}const y=document.createElement("button");y.id="copy-btn",y.textContent="Copy Layout",y.addEventListener("click",()=>{var g;(g=this._onCopy)==null||g.call(this,this._selectedNode.id)}),this._formContainer.appendChild(y)}}const _=document.getElementById("connection-dropdown"),P=document.getElementById("connection-dropdown-btn"),T=document.getElementById("connection-dropdown-menu"),v=document.getElementById("session-dropdown"),C=document.getElementById("session-dropdown-btn"),z=document.getElementById("session-list"),te=document.getElementById("session-create"),F=document.getElementById("save-session-btn"),ne=document.getElementById("autosave-label"),w=document.getElementById("autosave-checkbox");let u=null;const V="layout-editor-autosave";w.checked=localStorage.getItem(V)==="true";const J=()=>{F.disabled=!p.isConnected||w.checked};w.addEventListener("change",()=>{localStorage.setItem(V,String(w.checked)),J()});J();const B=new Q("tree-view"),h=new ee("property-form","no-selection"),se=()=>{const n=h.getPendingChanges();if(n.size>0){console.log(`[Layout Editor] Applying ${n.size} pending changes...`);for(const[e,t]of n)for(const[o,s]of Object.entries(t))p.send({type:"set-property",id:e,property:o,value:s})}},q=n=>{v.style.display=n?"block":"none",F.style.display=n?"inline-block":"none",ne.style.display=n?"flex":"none",n&&J()};B.onSelect(n=>{h.setSelectedNode(n),p.send({type:"highlight",id:(n==null?void 0:n.id)||null})});B.onHover(n=>{const e=n??B.getSelectedId();p.send({type:"highlight",id:e})});h.onChange((n,e,t)=>{p.send({type:"set-property",id:n,property:e,value:t}),w.checked&&u&&h.saveSession(u)});h.onCopy(n=>{p.send({type:"get-layout",id:n})});const G=n=>{if(P.textContent=n?"Connected":"Disconnected",P.classList.toggle("connected",n),P.classList.toggle("disconnected",!n),T.innerHTML="",n){const e=document.createElement("div");e.className="dropdown-item",e.textContent="Refresh",e.addEventListener("click",()=>{p.send({type:"get-hierarchy"}),_.classList.remove("open")});const t=document.createElement("div");t.className="dropdown-item",t.textContent="Disconnect",t.addEventListener("click",()=>{p.disconnect(),_.classList.remove("open")}),T.appendChild(e),T.appendChild(t)}else{const e=document.createElement("div");e.className="dropdown-item",e.textContent="Connect",e.addEventListener("click",()=>{p.connect(),_.classList.remove("open")}),T.appendChild(e)}};p.onStatusChange(n=>{G(n),q(n)});P.addEventListener("click",()=>{_.classList.toggle("open")});G(!1);p.on("hierarchy",n=>{B.setHierarchy(n.data)});p.on("updated",n=>{h.updateNodeLayout(n.id,n.layout,n.transform)});p.on("layout-config",n=>{const e=JSON.stringify(n.config,null,2);navigator.clipboard.writeText(e).then(()=>{alert("Layout copied to clipboard!")})});const k=()=>{const n=h.getSessions();z.innerHTML="",n.forEach(e=>{const t=document.createElement("div");t.className="dropdown-item",e===u&&t.classList.add("selected");const o=document.createElement("span");o.className="session-name",o.textContent=e;const s=document.createElement("button");s.className="delete-btn",s.textContent="✕",s.addEventListener("click",i=>{i.stopPropagation(),confirm(`Delete session "${e}"?`)&&(h.deleteSession(e),u===e&&(u=null,C.textContent="Select Session"),k())}),t.appendChild(o),t.appendChild(s),t.addEventListener("click",()=>{h.loadSession(e),u=e,C.textContent=e,v.classList.remove("open"),se(),k()}),z.appendChild(t)})};C.addEventListener("click",()=>{C.disabled||v.classList.toggle("open")});document.addEventListener("click",n=>{v.contains(n.target)||v.classList.remove("open"),_.contains(n.target)||_.classList.remove("open")});te.addEventListener("click",()=>{const n=prompt("New session name:");n&&n.trim()&&(h.saveSession(n.trim()),u=n.trim(),C.textContent=n.trim(),v.classList.remove("open"),k())});F.addEventListener("click",()=>{if(u)h.saveSession(u),console.log(`[Layout Editor] Saved to session: ${u}`);else{const n=prompt("No session loaded. Create new session:");n&&n.trim()&&(h.saveSession(n.trim()),u=n.trim(),C.textContent=n.trim(),k())}});q(!1);k();console.log("Layout Editor loaded");
